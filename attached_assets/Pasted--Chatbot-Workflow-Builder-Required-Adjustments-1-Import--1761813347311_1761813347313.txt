________________________________________
Chatbot Workflow Builder ‚Äî Required Adjustments
1) Import / Export
Goal: Let users back up and restore whole chatbots or move them between accounts.
‚Ä¢	Add ‚ÄúExport‚Äù: downloads a single JSON file for the currently open chatbot.
‚Ä¢	Add ‚ÄúImport‚Äù: uploads a JSON and replaces/creates the chatbot.
‚Ä¢	Versioning: include "schemaVersion": "1.0.x" at the root for future migrations.
‚Ä¢	IDs: preserve node IDs on import; if an ID collision exists, generate new IDs and remap links consistently.
‚Ä¢	Validation: on import, validate required fields; show a readable error list with line/field pointers.
Export file shape (example):
{
  "schemaVersion": "1.0.0",
  "bot": {
    "id": "bot_123",
    "name": "My Bot",
    "createdAt": 1730200000
  },
  "nodes": [
    {
      "id": "n_welcome",
      "type": "message.text",
      "name": "Welcome",
      "config": { "text": "Welcome üëã Choose an option." },
      "outputs": [{ "label": "default", "to": "n_buttons" }],
      "position": { "x": 160, "y": 120 }
    }
  ]
}
________________________________________
2) Merge ‚ÄúCall Button‚Äù + ‚ÄúLink Button‚Äù into a single node

Goal: -adjust ‚Äì the ‚ÄúMessage with Call button and Link button‚Äù is one button not two separate buttons, Merage them into one node as per the decontamination
‚Ä¢	Reference: https://support.whapi.cloud/help-desk/sending/send-message-with-buttons
Runtime mapping (to WHAPI):
‚Ä¢	Map config.text ‚Üí message body
‚Ä¢	Map buttons[*].kind to WHAPI button type
‚Ä¢	Map buttons[*].value to phone_number or url as required by WHAPI
‚Ä¢	Keep buttons[*].id for reply matching (we parse the reply payload‚Äôs ID to route flow)
________________________________________
3) Remove ‚ÄúCopy/OTP‚Äù button type
‚Ä¢	Delete the Copy/OTP node and any references in UI/menus.
________________________________________
4) Add new End-Node message types
These nodes send a message and STOP. They do not expose outputs or links to next nodes. They can still be targets from previous nodes.
4.1 message.text (End Node)
‚Ä¢	Reference: https://whapi.readme.io/reference/sendmessagetext
‚Ä¢	Runtime: Call WHAPI Send Text endpoint. No subsequent routing.
4.2 message.media (End Node)
‚Ä¢	Reference: https://whapi.readme.io/reference/sendmediamessage
‚Ä¢	Config (minimal):
‚Ä¢	Runtime: Call WHAPI Send Media endpoint with correct mediaType (image, video, audio, document, sticker, etc.) and caption where supported.
4.3 message.location (End Node)
‚Ä¢	Reference: https://whapi.readme.io/reference/sendmessagelocation
‚Ä¢	Runtime: Call WHAPI Send Location endpoint.
UI Rule: End-nodes show a small ‚ÄúEND‚Äù badge and do not allow drawing connectors out of them.
________________________________________
5) Reply Routing (unchanged, but confirm)
‚Ä¢	Webhook only listens when chatbot is LIVE.
‚Ä¢	For button replies, parse the reply payload (e.g., id or suffix after : per WHAPI convention).
o	Match to the button ID in message.buttons.config.buttons[*].id
o	Follow the matching button‚Äôs to link.
‚Ä¢	For plain text messages, your separate ‚Äúfirst message of the day‚Äù logic is out of scope here (we already handle it and its done no changes).
________________________________________
6) Builder UX details
‚Ä¢	Keep horizontal linking between nodes (left-to-right) to reduce edge overlaps.
‚Ä¢	Show per-button labels on each output handle so users know which path they‚Äôre wiring.
‚Ä¢	Disable ‚ÄúAdd Output‚Äù on End-Nodes.
‚Ä¢	Drag-drop canvas should allow zoom and pan; large area is preferred (we mentioned this previously).
________________________________________
7) Acceptance Criteria (QA Checklist)
1.	Import/Export
o	Export produces a single JSON with schemaVersion.
o	Import restores nodes/links/positions; collisions are resolved and reported.
2.	Buttons Node
o	One node handles both phone and URL buttons, up to 3 total.
o	Each button can route to a different node.
o	Replies route correctly by button id.
3.	Copy/OTP Removal
o	No Copy/OTP node in the palette.
4.	End-Nodes
o	message.text, message.media, message.location send their payload then stop.
o	End-nodes cannot have outputs in the UI.
5.	Runtime
o	WHAPI requests match the three linked references above.
o	Errors bubble up with clear logs and user-visible error toasts (endpoint, status, short message).
________________________________________
If you need any additional field names to match WHAPI exactly, let me know and I‚Äôll provide concrete payload examples from our side.

